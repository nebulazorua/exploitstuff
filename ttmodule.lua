local player = game:service'Players'.localPlayer;
local TTModule = {}
local worldModels = workspace:WaitForChild'WorldModels'

local meta = getrawmetatable(game)
local oldNamecall = meta.__namecall
setreadonly(meta,false)
meta.__namecall=newcclosure(function(i,...)
    if(i.Name=='UpdateSettings')then
        local a = {...}
        TTModule.Key=a[1];
        setreadonly(meta,false)
        meta.__namecall=oldNamecall;
    end
    return oldNamecall(i,...)
end)
repeat wait() until TTModule.Key;
setreadonly(meta,true)

TTModule.Weapons={
	[1]={
		"Crowbar";
	};
	
	[2]={
		'Pistol';
		'Deagle';
		'Glock';
	};
	
	[3]={
		'Rifle';
		'M16';
		'MAC10';
		'Shotgun';
		'HUGE-249';
	};
	
	[4]={
		'Discombobulator';
		'Incendiary grenade';
		'Smoke grenade';
	};
	
	[5]={
		'Magneto-stick'
	};
	
	[6]={
		'Holstered';
	};
	
	[7]={
		'Flare gun';
		'Headtaker';
		'Knife';
		'Melon launcher';
		'UMP Prototype';
		'Health Station';
		'Death Station';
		'Golden gun';
		'AWP';
		'Turtle';
		'C4';
		'Visualizer';
		'Silenced Pistol';
	};
	
	[8]={
		'Radio';
		'Newton launcher';
		'Teleporter';
		'Poltergeist';
		'Defuser';
		'Nyan gun';
		'Binoculars'; 
	};
	
	[9]={
		'DNA scanner';
		'Pigsticker';
		'True Headtaker';
		'Fists';
	}
}

TTModule.TraitorItems={
	'Body Armor';
	'C4';
	'Decoy';
	'Disguiser';
	'Jihad bomb';
	'Knife';
	'Newton launcher';
	'Poltergeist';
	'Radar';
	'Radio';
	'Silenced Pistol';
	'Teleporter';
	'Flare gun';
	'Melon launcher';
	'AWP';
	'Death Station';
	'Headtaker';
	'Turtle';
}

TTModule.DetectiveItems={
	'Radar';
	'Binoculars';
	'Defuser';
	'Visualizer';
	'Health Station';
	'Teleporter';
	'UMP Prototype';
	'Golden gun';
	'Nyan gun';
}

TTModule.FireServer=function(self,remote,...)
    remote:FireServer(self.Key,...)
end

TTModule.PropVelocity=function(self,prop,velocity)
	self:FireServer(workspace.ServerEvents.ManagePOM,'Connect',prop)
	self:FireServer(workspace.ServerEvents.ManagePOM,'Space',prop,velocity)
	self:FireServer(workspace.ServerEvents.ManagePOM,'Disconnect',prop)
end

TTModule.ConfirmDeath=function(self,player)
	self:FireServer(workspace.ServerEvents.ConfirmDeath,player) 
end

TTModule.DeleteProp=function(self,prop)
	self:PropVelocity(prop,Vector3.new(0,9e9,0))
end

TTModule.TakeFallDamage=function(self,amount)
	self:FireServer(workspace.ServerEvents.Fall,amount)
end

TTModule.HitObject=function(self,object,weapon)
	self:FireServer(workspace.ServerEvents.FireWeapon,weapon or "Crowbar",0,object.CFrame,object,object.CFrame,object.CFrame,object,object.Position,Vector3.new(),0,0,0)	
end

TTModule.BurnPart=function(self,object)
	self:HitObject(object,'Flare gun')
end

TTModule.CrowbarPush=function(self,player,velocity)
	self:FireServer(workspace.ServerEvents.CrowbarPush,player,velocity)
end

TTModule.OpenDoor=function(self,door)
	self:FireServer(workspace.ServerEvents.Door,door)
end

TTModule.PressTButton=function(self,button)
	if(button.Name=='TraitorNode')then
		self:FireServer(workspace.ServerEvents.Button,button:FindFirstChildOfClass'ModuleScript')
	else
		self:FireServer(workspace.ServerEvents.Button,button:WaitForChild'TraitorNode':FindFirstChildOfClass'ModuleScript')
	end
end

TTModule.PurchaseEquipment=function(self,equipment)
	self:FireServer(workspace.ServerEvents.PurchaseEquipment,equipment)
end

TTModule.UseHealthStation=function(self,hs)
	self:FireServer(workspace.ServerEvents.UseHealth,hs)
end

TTModule.SpawnWeapon=function(self,name)
	local weapon = worldModels:FindFirstChild(name)
	if(weapon)then
		local char = player.Character;
		if(char)then
			local clone = weapon:Clone()
			clone.Parent=char:WaitForChild'PossessedWeapons'
			local mag = Instance.new("NumberValue",clone)
			mag.Name='Magazine'
			mag.Value=1
			return clone
		end
	end
end

return TTModule;
